/* Add this rule at the top if not already present */
*, *::before, *::after {
    box-sizing: border-box;
}

body {
    font-family: sans-serif;
    line-height: 1.6;
    margin: 20px;
    background-color: #f4f4f4;
    color: #333;
}

h1, h2 {
    text-align: center;
    margin-bottom: 10px;
}

p {
    font-size: 0.9em;
    color: #555;
    min-height: 1.2em;
    text-align: center;
}

/* Monitor Area Layout */
.monitor-area-wrapper {
    display: flex;
    flex-direction: column; /* Stack monitor rows */
    align-items: center; /* Center monitor rows */
    gap: 20px;
    margin-bottom: 30px;
}

.monitor-and-controls-wrapper {
    display: flex;
    flex-wrap: wrap; /* Allow wrapping on smaller screens */
    justify-content: center;
    align-items: flex-start; /* Align tops */
    gap: 20px;
    width: 100%; /* Take full width */
    max-width: 800px; /* Limit max width */
}

/* Monitor Canvas Styles */
.monitor-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 0 0 350px; /* Fixed base size for monitor block */
}

#monitorCanvas, #monitorCanvas2 {
    border: 2px solid #333;
    display: block;
    margin: 0 auto 10px auto;
    max-width: 100%; /* Allow shrinking if container is too small */
    width: 350px;   /* Explicit width */
    height: 350px;  /* Explicit height */
    background-color: #eee;
}

#monitorStatus, #monitorStatus2 {
    font-style: italic;
    color: #333;
    font-weight: bold;
    min-height: 1.2em; /* Ensure space */
}

/* Sampling Form Specific Styles */
.sampling-form-container {
    flex: 1 1 250px; /* Allow sampling form to grow/shrink */
    max-width: 300px;
    align-self: center; /* Vertically center form next to monitor */
}

.sampling-form-container h2 {
    font-size: 1.0em; /* Smaller heading */
}

.sampling-form-container fieldset {
    padding: 8px 12px 12px 12px;
    margin-bottom: 10px;
}
.sampling-form-container legend {
    font-size: 0.9em;
}
.sampling-form-container label {
    font-size: 0.9em;
}
.sampling-form-container .form-group label {
    flex-basis: 100px; /* Adjust label width */
}
.sampling-form-container .form-group span {
    flex-basis: 60px; /* Adjust span width */
}


/* Lower Canvas & Controls Layout */
.canvas-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: flex-start; /* Keep alignment */
    gap: 20px;
    margin-top: 20px;
    margin-bottom: 30px;
}

.canvas-wrapper {
    text-align: center;
    flex-basis: 350px; /* Base width for each item */
    max-width: 100%;   /* Allow shrinking */
    display: flex;
    flex-direction: column;
    align-items: center;
    /* Remove fixed height/width if applied here previously */
    /* width: 350px; */
    /* height: 350px; */
}

/* NEW Container specifically for P3/Overlay positioning */
.p3-canvas-relative-container {
    position: relative; /* This is the positioning parent */
    width: 350px;       /* Match canvas size */
    height: 350px;      /* Match canvas size */
    margin: 0 auto 10px auto; /* Center and add bottom margin like other canvases */
    flex-shrink: 0;     /* Prevent shrinking within flex layout */
}


canvas { /* Default for OTHER canvases if any */
    border: 1px solid #ccc;
    display: block;
    margin: 0 auto 10px auto; /* Default margin */
    max-width: 100%; /* Allow shrinking by default */
    height: auto; /* Maintain aspect ratio by default */
    background-color: #fff;
}

/* Specific styles for p3Canvas and overlayCanvas */
#p3Canvas, #overlayCanvas {
    display: block;
    width: 350px;   /* Force CSS width to match attribute */
    height: 350px;  /* Force CSS height to match attribute */
    max-width: none; /* Override default max-width */
    margin: 0;       /* Reset margin as they are inside the relative container */
    border: 1px solid #ccc; /* Keep border for p3 */
    background-color: #fff; /* Background for p3 */
}

/* The Overlay Canvas */
#overlayCanvas {
    position: absolute;
    top: 0;             /* Relative to p3-canvas-relative-container */
    left: 0;            /* Relative to p3-canvas-relative-container */
    width: 350px;       /* Match parent */
    height: 350px;      /* Match parent */
    border: none;       /* No border for overlay */
    background-color: transparent;
    pointer-events: none;
    z-index: 10;
}

/* Interactive Canvases */
#angleScaleCanvas, #positionCanvas {
   cursor: crosshair;
   background-color: #e9e9e9;
   border: 1px dashed #999;
   /* Ensure these also match their attributes */
   width: 350px;
   height: 350px;
   max-width: none; /* Override max-width */
   margin: 0 auto 10px auto; /* Keep standard margin */
}

#p3Status, #overlayStatus, #angleScaleStatus, #positionStatus {
    font-style: italic;
    color: #555;
    font-size: 0.85em;
    word-wrap: break-word;
    min-height: 2.4em;
}
#overlayStatus {
    font-weight: bold;
}

/* --- Controls Container --- */
.controls-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
    padding: 0 10px;
}


/* --- Form Styles --- */
.form-container { /* Base style for all form containers */
    flex: 1 1 300px;
    max-width: 380px;
    padding: 15px 20px;
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 8px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.08);
}

.form-container h2 {
    margin-top: 0;
    margin-bottom: 15px;
    text-align: center;
    font-size: 1.1em;
}

#shapeForm, #angleScaleForm, #positionForm, #samplingForm { /* Apply to all forms */
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#shapeForm fieldset, #samplingForm fieldset { /* Specific fieldset styling */
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 10px 15px 15px 15px;
    margin: 0 0 10px 0;
}

#shapeForm legend, #samplingForm legend {
    font-weight: bold;
    padding: 0 5px;
    font-size: 0.95em;
}

#shapeForm label, #samplingForm label { /* Radio/Checkbox labels */
    display: block;
    margin-bottom: 5px;
    cursor: pointer;
    font-size: 0.95em;
}
#shapeForm input[type="radio"], #samplingForm input[type="radio"] {
    margin-right: 6px;
    vertical-align: middle;
}

.form-group { /* General form group */
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    gap: 10px;
}

.form-group label { /* General label in group */
    flex-basis: 120px;
    text-align: right;
    font-weight: bold;
    font-size: 0.9em;
    flex-shrink: 0;
}

.form-group input[type="range"] {
    flex-grow: 1;
    min-width: 80px;
    cursor: pointer;
}

.form-group span { /* General value span */
    flex-basis: 80px;
    text-align: right;
    font-family: monospace;
    background-color: #eee;
    padding: 3px 6px;
    border-radius: 4px;
    font-size: 0.9em;
    flex-shrink: 0;
}

.form-hint {
    font-size: 0.8em;
    color: #666;
    text-align: center;
    margin-top: 5px;
    font-style: italic;
}

/* Render Button Styles */
.render-button-container {
    text-align: center;
    margin: 30px 0;
}

#renderButton {
    padding: 12px 25px;
    font-size: 1.1em;
    font-weight: bold;
    color: #fff;
    background-color: #28a745; /* Green */
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

#renderButton:hover {
    background-color: #218838;
}

#renderButton:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}